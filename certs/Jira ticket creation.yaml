name: Jira ticket creation
platform: node
blocks:
  - action: foreach
    name: ForEach_1
    list: $server_list
    blocks:
      - action: assign
        name: description_update
        variable: $tmp_issue_description
        value: $tmp_issue_description + " \n -" + $ForEach_1.item
  - action: system/Atlassian/Jira v2/Issues/Create Issue
    name: Atlassian_create
    inputs:
      - name: authKey
        value: '"ibm_roja_adm@0000-0000-0000-0000/jira_stg"'
      - name: Body
        value: |-
          {
              "fields": {
                  "project": {
                      "key": "CODD"
                  },
                  "summary": "Created with Concert Workflow :)",
                  "description": "Creating of an issue using project keys and \n issue type names using the REST API \n With this list:\n" + $tmp_issue_description,

                  "issuetype": {
                      "name": "Story"
                  }
              }
          }
  - action: assign
    name: Assign_1
    variable: $result
    value: $Atlassian_create.result.self
variables:
  - name: result
    required: false
    isInput: false
    isOutput: true
    level: INTERMEDIATE
    type:
      type: any
    value: '""'
  - name: jira_key
    required: false
    isInput: false
    isOutput: false
    level: INTERMEDIATE
    type:
      type: string
    value: '"ajSGtvHKV7ASvt7n5KHAsavJcu3dXa6JrBlH8D"'
  - name: server_list
    required: false
    isInput: false
    isOutput: false
    level: INTERMEDIATE
    type:
      type: array
    value: "[\"/root/concert/workflows/bin/keysore\", \"/root/concert/workflows/bin/keysore2\"\
      , \"/root/concert/workflows/bin/keysore.jks\"]"
  - name: tmp_issue_description
    required: false
    isInput: false
    isOutput: false
    level: INTERMEDIATE
    type:
      type: string
    value: '""'
meta:
  workerGroup: default
  layout: flow
  version: 5
finally: null
